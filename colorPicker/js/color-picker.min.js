var ColorPicker=class t{constructor(t,e={}){if(this.container=document.querySelector(t),!this.container){console.error("ColorPicker: container element not found for selector",t);return}this.options={initialColor:e.initialColor||"#3388ff",showAlpha:void 0===e.showAlpha||e.showAlpha,position:e.position||"auto",format:e.format||"auto",showTextInput:void 0===e.showTextInput||e.showTextInput},this.color=this.parseColor(this.options.initialColor)||this.hsvToRgb(200/360,1,1,1),this.textInput=null,this.nativeColorInput=null,this.trigger=null,this.popup=null,this.saturationEl=null,this.cursorEl=null,this.hueSlider=null,this.alphaSlider=null,this.hueCursor=null,this.alphaCursor=null,this.isPopupOpen=!1,this._resizeHandler=null,this.init()}init(){this.container.classList.contains("color-picker")||this.container.classList.add("color-picker"),this.createDOM(),this.bindEvents(),this.updateUI()}createDOM(){this.container.innerHTML="",this.textInput=document.createElement("input"),this.textInput.type="text",this.textInput.className="text-input",this.textInput.placeholder="HEX, RGB, HSL...",this.options.showTextInput||(this.textInput.style.display="none"),this.nativeColorInput=document.createElement("input"),this.nativeColorInput.type="color",this.nativeColorInput.className="native-input",this.trigger=document.createElement("div"),this.trigger.className="swatch",this.popup=document.createElement("div"),this.popup.className="popover",this.popup.innerHTML=`
        <div class="saturation">
          <div class="cursor"></div>
        </div>
        <div class="hue">
          <div class="cursor"></div>
        </div>
        ${this.options.showAlpha?`
        <div class="alpha">
          <div class="bg"></div>
          <div class="cursor"></div>
        </div>`:""}
      `,this.popup.style.display="none",this.saturationEl=this.popup.querySelector(".saturation"),this.cursorEl=this.saturationEl.querySelector(".cursor"),this.hueSlider=this.popup.querySelector(".hue"),this.hueCursor=this.hueSlider.querySelector(".cursor"),this.options.showAlpha&&(this.alphaSlider=this.popup.querySelector(".alpha"),this.alphaCursor=this.alphaSlider.querySelector(".cursor")),this.container.appendChild(this.textInput),this.container.appendChild(this.nativeColorInput),this.container.appendChild(this.trigger),this.container.appendChild(this.popup)}bindEvents(){this.trigger.addEventListener("click",t=>{t.stopPropagation(),this.togglePopup()}),document.addEventListener("click",t=>{!this.container.contains(t.target)&&this.isPopupOpen&&this.closePopup()}),this.textInput.addEventListener("change",t=>{let e=this.parseColor(t.target.value);e?this.setColor(e):this.updateUI()}),this.bindSaturationEvents(),this.bindHueEvents(),this.options.showAlpha&&this.bindAlphaEvents(),this._resizeHandler=()=>{this.isPopupOpen&&this.positionPopup()},window.addEventListener("resize",this._resizeHandler),window.addEventListener("scroll",this._resizeHandler,!0)}bindSaturationEvents(){let t=(t,e)=>{let i=this.saturationEl.getBoundingClientRect(),s=t-i.left,o=e-i.top;s=Math.max(0,Math.min(s,i.width)),o=Math.max(0,Math.min(o,i.height));let r=s/i.width,n=1-o/i.height,l=this.hsvToRgb(this.color.h,r,n,this.color.a);this.setColor(l)},e=t=>{let e=e=>t(e.clientX,e.clientY),i=e=>{e.preventDefault();let i=e.touches[0];t(i.clientX,i.clientY)};document.addEventListener("mousemove",e),document.addEventListener("touchmove",i,{passive:!1});let s=()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",s),document.removeEventListener("touchmove",i),document.removeEventListener("touchend",s)};document.addEventListener("mouseup",s),document.addEventListener("touchend",s)};this.saturationEl.addEventListener("mousedown",i=>{i.preventDefault(),t(i.clientX,i.clientY),e(t)}),this.saturationEl.addEventListener("touchstart",i=>{i.preventDefault();let s=i.touches[0];t(s.clientX,s.clientY),e(t)})}bindHueEvents(){let t=t=>{let e=this.hueSlider.getBoundingClientRect(),i=t-e.left;i=Math.max(0,Math.min(i,e.width));let s=i/e.width,o=this.hsvToRgb(s,this.color.s,this.color.v,this.color.a);this.setColor(o)},e=t=>{let e=e=>t(e.clientX),i=e=>{e.preventDefault(),t(e.touches[0].clientX)};document.addEventListener("mousemove",e),document.addEventListener("touchmove",i,{passive:!1});let s=()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",s),document.removeEventListener("touchmove",i),document.removeEventListener("touchend",s)};document.addEventListener("mouseup",s),document.addEventListener("touchend",s)};this.hueSlider.addEventListener("mousedown",i=>{i.preventDefault(),t(i.clientX),e(t)}),this.hueSlider.addEventListener("touchstart",i=>{i.preventDefault(),t(i.touches[0].clientX),e(t)})}bindAlphaEvents(){let t=t=>{let e=this.alphaSlider.getBoundingClientRect(),i=t-e.left;i=Math.max(0,Math.min(i,e.width));let s=Math.round(i/e.width*100)/100,o={...this.color,a:s};o.hex=this.rgbToHex(o.r,o.g,o.b),this.setColor(o)},e=t=>{let e=e=>t(e.clientX),i=e=>{e.preventDefault(),t(e.touches[0].clientX)};document.addEventListener("mousemove",e),document.addEventListener("touchmove",i,{passive:!1});let s=()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",s),document.removeEventListener("touchmove",i),document.removeEventListener("touchend",s)};document.addEventListener("mouseup",s),document.addEventListener("touchend",s)};this.alphaSlider.addEventListener("mousedown",i=>{i.preventDefault(),t(i.clientX),e(t)}),this.alphaSlider.addEventListener("touchstart",i=>{i.preventDefault(),t(i.touches[0].clientX),e(t)})}togglePopup(){this.isPopupOpen?this.closePopup():this.openPopup()}openPopup(){this.popup.style.display="block",this.isPopupOpen=!0,setTimeout(()=>{this.updateUI(),this.positionPopup()},0)}closePopup(){this.popup.style.display="none",this.isPopupOpen=!1}setColor(t){this.color=t,this.updateUI()}formatColorForDisplay(t){let{r:e,g:i,b:s,a:o,h:r,s:n,l}=t,h=this.options.showAlpha?parseFloat(o.toFixed(2)):1;switch(this.options.format){case"hex":return t.hex;case"rgb":return`rgb(${e}, ${i}, ${s})`;case"rgba":return`rgba(${e}, ${i}, ${s}, ${h})`;case"hsl":return`hsl(${Math.round(360*r)}, ${Math.round(100*n)}%, ${Math.round(100*l)}%)`;case"hsla":return`hsla(${Math.round(360*r)}, ${Math.round(100*n)}%, ${Math.round(100*l)}%, ${h})`;default:if(this.options.showAlpha&&h<1)return`rgba(${e}, ${i}, ${s}, ${h})`;return t.hex}}updateUI(){let{hex:t,r:e,g:i,b:s,a:o,h:r,s:n,v:l,l:h}=this.color;if(this.textInput.value=this.formatColorForDisplay(this.color),this.nativeColorInput.value=this.rgbToHex(e,i,s),this.trigger.style.backgroundColor=this.rgbaToCss(e,i,s,o),this.saturationEl&&(this.saturationEl.style.background=`
          linear-gradient(to right, white, rgba(255,255,255,0)),
          linear-gradient(to top, black, rgba(0,0,0,0)),
          hsl(${360*r}, 100%, 50%)
        `),this.cursorEl&&this.saturationEl){let a=this.saturationEl.getBoundingClientRect();if(a.width>0&&a.height>0){let u=n*a.width,p=(1-l)*a.height;this.cursorEl.style.left=`${u}px`,this.cursorEl.style.top=`${p}px`}}if(this.hueCursor&&this.hueSlider){let d=this.hueSlider.getBoundingClientRect();if(d.width>0){let c=r*d.width;this.hueCursor.style.left=`${c}px`}}if(this.alphaCursor&&this.alphaSlider){let v=this.alphaSlider.getBoundingClientRect();if(v.width>0){let g=parseFloat(o.toFixed(2)),$=g*v.width;this.alphaCursor.style.left=`${$}px`,this.alphaSlider.querySelector(".bg").style.background=`
            linear-gradient(to right, rgba(${e}, ${i}, ${s}, 0), rgba(${e}, ${i}, ${s}, ${g})),
            repeating-conic-gradient(#ccc 0% 25%, transparent 0% 50%) 0 0 / 16px 16px
          `}}}positionPopup(){if(!this.popup||!this.trigger)return;let t=this.trigger.getBoundingClientRect(),e=this.popup.getBoundingClientRect(),i=window.innerWidth,s=window.innerHeight,o=["bottom-left","bottom-center","bottom-right","top-left","top-center","top-right","right","left"],r=this.options.position;if("auto"===this.options.position){for(let n of o){let{x:l,y:h,fits:a}=this.calculatePosition(n,t,e,i,s,8);if(a){r=n,this.applyPosition(l,h);return}}r=o[0]}let{x:u,y:p}=this.calculatePosition(r,t,e,i,s,8);this.applyPosition(u,p)}calculatePosition(t,e,i,s,o,r){let n=0,l=0;switch(t){case"top-left":n=e.right-i.width,l=e.top-i.height-r;break;case"top-center":n=e.left+e.width/2-i.width/2,l=e.top-i.height-r;break;case"top-right":n=e.left,l=e.top-i.height-r;break;case"bottom-left":n=e.right-i.width,l=e.bottom+r;break;case"bottom-center":n=e.left+e.width/2-i.width/2,l=e.bottom+r;break;case"bottom-right":default:n=e.left,l=e.bottom+r;break;case"right":n=e.right+r,l=e.top+e.height/2-i.height/2;break;case"left":n=e.left-i.width-r,l=e.top+e.height/2-i.height/2}let h=n>=0&&l>=0&&n+i.width<=s&&l+i.height<=o;return{x:n,y:l,fits:h}}applyPosition(t,e){this.popup.style.position="fixed",this.popup.style.left=`${t}px`,this.popup.style.top=`${e}px`,this.popup.style.right="auto",this.popup.style.bottom="auto"}hsvToRgb(t,e,i,s=1){let o,r,n,l=Math.floor(6*t),h=6*t-l,a=i*(1-e),u=i*(1-h*e),p=i*(1-(1-h)*e);switch(l%6){case 0:o=i,r=p,n=a;break;case 1:o=u,r=i,n=a;break;case 2:o=a,r=i,n=p;break;case 3:o=a,r=u,n=i;break;case 4:o=p,r=a,n=i;break;case 5:o=i,r=a,n=u}o=Math.round(255*o),r=Math.round(255*r),n=Math.round(255*n);let d=Math.min(o,r,n)/255,c=Math.max(o,r,n)/255,v=this.rgbToHex(o,r,n);return{r:o,g:r,b:n,a:s,h:t,s:e,v:i,l:(d+c)/2,hex:v}}parseColor(t){if((t=t.trim().toLowerCase()).startsWith("#")){let e=t.substring(1),i,s,o;if(3===e.length)i=parseInt(e[0]+e[0],16),s=parseInt(e[1]+e[1],16),o=parseInt(e[2]+e[2],16);else{if(6!==e.length)return null;i=parseInt(e.substring(0,2),16),s=parseInt(e.substring(2,4),16),o=parseInt(e.substring(4,6),16)}let{h:r,s:n,v:l}=this.rgbToHsv(i,s,o),h=Math.min(i,s,o)/255,a=Math.max(i,s,o)/255;return{r:i,g:s,b:o,a:1,h:r,s:n,v:l,l:(h+a)/2,hex:`#${e.padStart(6,"0")}`}}let u=t.match(/^rgba?\s*\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*([\d.]+)\s*)?\)$/);if(u){let[p,d,c,v,g]=u,$=parseInt(d,10),m=parseInt(c,10),b=parseInt(v,10),_=void 0!==g?parseFloat(parseFloat(g).toFixed(2)):1;if($<0||$>255||m<0||m>255||b<0||b>255||_<0||_>1)return null;let{h:E,s:f,v:x}=this.rgbToHsv($,m,b),C=this.rgbToHex($,m,b);return{r:$,g:m,b,a:_,h:E,s:f,v:x,l:(Math.min($,m,b)/255+Math.max($,m,b)/255)/2,hex:C}}let w=t.match(/^hsla?\s*\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*(?:,\s*([\d.]+)\s*)?\)$/);if(w){let[L,y,S,P,I]=w,T=parseInt(y,10)/360,k=parseInt(S,10)/100,H=parseInt(P,10)/100,R=void 0!==I?parseFloat(parseFloat(I).toFixed(2)):1;if(T<0||T>1||k<0||k>1||H<0||H>1||R<0||R>1)return null;let{r:D,g:X,b:A}=this.hslToRgb(T,k,H),{h:B,s:q,v:O}=this.rgbToHsv(D,X,A),F=this.rgbToHex(D,X,A);return{r:D,g:X,b:A,a:R,h:B,s:q,v:O,l:H,hex:F}}return null}rgbToHsv(t,e,i){t/=255,e/=255,i/=255;let s=Math.max(t,e,i),o=Math.min(t,e,i),r=s-o,n,l,h;if(0===r)n=0,l=0;else{l=r/s;let a=((s-t)/6+r/2)/r,u=((s-e)/6+r/2)/r,p=((s-i)/6+r/2)/r;t===s?n=p-u:e===s?n=1/3+a-p:i===s&&(n=2/3+u-a),n=(n+1)%1}let d=Math.min(t,e,i)/255,c=Math.max(t,e,i)/255;return h=(d+c)/2,{h:n,s:l,v:s,l:h}}hslToRgb(t,e,i){let s,o,r;if(0===e)s=o=r=i;else{let n=(t,e,i)=>(i<0&&(i+=1),i>1&&(i-=1),i<1/6)?t+(e-t)*6*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t,l=i<.5?i*(1+e):i+e-i*e,h=2*i-l;s=n(h,l,t+1/3),o=n(h,l,t),r=n(h,l,t-1/3)}return{r:Math.round(255*s),g:Math.round(255*o),b:Math.round(255*r)}}rgbToHex(t,e,i){return`#${[t,e,i].map(t=>t.toString(16).padStart(2,"0")).join("")}`}rgbaToCss(t,e,i,s){let o=parseFloat(s.toFixed(2));return`rgba(${t}, ${e}, ${i}, ${o})`}};